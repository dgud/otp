%%
%% %CopyrightBegin%
%%
%% Copyright Ericsson AB 2011-2024. All Rights Reserved.
%%
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%%
%%     http://www.apache.org/licenses/LICENSE-2.0
%%
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.
%%
%% %CopyrightEnd%
%%

%%

-module(ssl_dist_sup).
-moduledoc false.

-behaviour(supervisor).

%% API
-export([start_link/0]).

%% Supervisor callback
-export([init/1]).

%% Debug
-export([consult/1]).

%%%=========================================================================
%%%  API
%%%=========================================================================

-spec start_link() -> {ok, pid()} | ignore | {error, term()}.
			
start_link() ->
    case init:get_argument(ssl_dist_optfile) of
        {ok, [File]} ->
            DistOpts = consult(File),
            TabOpts = [set, protected, named_table],
            Tab = ets:new(ssl_dist_opts, TabOpts),
            true = ets:insert(Tab, DistOpts),
            supervisor:start_link({local, ?MODULE}, ?MODULE, []);
        {ok, BadArg} ->
            error({bad_ssl_dist_optfile, BadArg});
        error ->
            DistOpts = default_opts(),
            TabOpts = [set, protected, named_table],
            Tab = ets:new(ssl_dist_opts, TabOpts),
            true = ets:insert(Tab, DistOpts),

            supervisor:start_link({local, ?MODULE}, ?MODULE, [])
    end.

%%%=========================================================================
%%%  Supervisor callback
%%%=========================================================================

init([]) ->    
    SupFlags = #{strategy  => one_for_all, 
                 intensity =>   10,
                 period    => 3600
                },
    ChildSpecs = [ssl_admin_child_spec(),
                  ssl_connection_sup()], 
    {ok, {SupFlags, ChildSpecs}}.

%%--------------------------------------------------------------------
%%% Internal functions
%%--------------------------------------------------------------------
ssl_admin_child_spec() ->
    #{id       => ssl_dist_admin_sup,
      start    =>  {ssl_dist_admin_sup, start_link , []},
      restart  => permanent, 
      shutdown => 4000,
      modules  => [ssl_dist_admin_sup],
      type     => supervisor
     }.
    
ssl_connection_sup() ->
    #{id       => tls_dist_sup,
      start    => {tls_dist_sup, start_link, []},
      restart  => permanent, 
      shutdown => 4000,
      modules  => [tls_dist_sup],
      type     => supervisor
     }.

consult(File) ->
    case erl_prim_loader:read_file(File) of
        {ok, Binary} ->
            Encoding =
                case epp:read_encoding_from_binary(Binary) of
                    none -> latin1;
                    Enc -> Enc
                end,
            case unicode:characters_to_list(Binary, Encoding) of
                {error, _String, Rest} ->
                    error(
                      {bad_ssl_dist_optfile, {encoding_error, Rest}});
                {incomplete, _String, Rest} ->
                    error(
                      {bad_ssl_dist_optfile, {encoding_incomplete, Rest}});
                String when is_list(String) ->
                    consult_string(String)
            end;
        error ->
            error({bad_ssl_dist_optfile, File})
    end.

consult_string(String) ->
    case erl_scan:string(String) of
        {error, Info, Location} ->
            error({bad_ssl_dist_optfile, {scan_error, Info, Location}});
        {ok, Tokens, _EndLocation} ->
            consult_tokens(Tokens)
    end.

consult_tokens(Tokens) ->
    case erl_parse:parse_exprs(Tokens) of
        {error, Info} ->
            error({bad_ssl_dist_optfile, {parse_error, Info}});
        {ok, [Expr]} ->
            consult_expr(Expr);
        {ok, Other} ->
            error({bad_ssl_dist_optfile, {parse_error, Other}})
    end.

consult_expr(Expr) ->
    {value, Value, Bs} = erl_eval:expr(Expr, erl_eval:new_bindings()),
    case erl_eval:bindings(Bs) of
        [] ->
            Value;
        Other ->
            error({bad_ssl_dist_optfile, {bindings, Other}})
    end.

default_opts() ->
    [{server,
      [{fail_if_no_peer_cert,true},
       {verify,verify_peer},
       {versions,['tlsv1.3']},
       {ciphers,[#{key_exchange => any,cipher => aes_128_gcm,mac => aead,
                   prf => sha256}]},
       {cert,<<48,130,2,80,48,130,1,236,160,3,2,1,2,2,1,3,48,20,6,8,42,134,
               72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,150,49,35,
               48,33,6,9,42,134,72,134,247,13,1,9,1,22,20,119,101,98,97,
               100,109,105,110,64,101,120,97,109,112,108,101,46,111,114,
               103,49,33,48,31,6,3,85,4,3,19,24,115,101,114,118,101,114,32,
               73,110,116,101,114,109,101,100,105,97,116,101,32,67,65,32,
               48,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,107,104,111,
               108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,
               4,10,19,6,101,114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,
               17,97,117,116,111,109,97,116,101,100,32,116,101,115,116,105,
               110,103,48,30,23,13,50,52,49,49,49,56,49,51,48,48,48,48,90,
               23,13,50,52,49,49,50,54,49,51,48,48,48,48,90,48,129,139,49,
               32,48,30,6,9,42,134,72,134,247,13,1,9,1,22,17,97,100,109,
               105,110,64,101,120,97,109,112,108,101,46,111,114,103,49,25,
               48,23,6,3,85,4,3,19,16,115,101,114,118,101,114,32,80,101,
               101,114,32,99,101,114,116,49,18,48,16,6,3,85,4,7,19,9,83,
               116,111,99,107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,
               83,69,49,15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,
               49,26,48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
               100,32,116,101,115,116,105,110,103,48,89,48,19,6,7,42,134,
               72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,3,66,0,4,18,82,152,
               32,21,222,20,67,80,135,183,75,76,10,102,227,134,60,10,36,
               159,132,116,143,11,99,120,225,27,185,196,223,7,18,164,104,
               15,63,26,60,171,201,108,252,192,245,142,193,43,13,67,138,
               164,187,93,3,48,9,193,45,200,255,18,122,163,42,48,40,48,11,
               6,3,85,29,15,4,4,3,2,3,136,48,25,6,3,85,29,17,4,18,48,16,
               130,14,101,108,120,45,99,110,100,49,52,56,55,118,107,49,48,
               20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,3,
               72,0,48,69,2,33,0,249,76,34,204,122,125,172,107,125,93,26,
               195,121,140,234,117,32,209,56,202,146,137,79,235,4,133,143,
               246,144,136,143,92,2,32,109,186,153,71,133,36,244,184,228,
               71,58,47,187,103,75,77,97,16,139,24,172,5,115,4,163,184,85,
               50,174,114,196,136>>},
       {key,{'ECPrivateKey',<<48,119,2,1,1,4,32,228,91,82,33,146,248,200,
                              188,41,171,42,200,158,64,87,88,213,68,32,
                              213,131,249,207,52,168,112,192,243,129,103,
                              147,109,160,10,6,8,42,134,72,206,61,3,1,7,
                              161,68,3,66,0,4,18,82,152,32,21,222,20,67,
                              80,135,183,75,76,10,102,227,134,60,10,36,
                              159,132,116,143,11,99,120,225,27,185,196,
                              223,7,18,164,104,15,63,26,60,171,201,108,
                              252,192,245,142,193,43,13,67,138,164,187,93,
                              3,48,9,193,45,200,255,18,122>>}},
       {cacerts,[<<48,130,2,54,48,130,1,209,160,3,2,1,2,2,1,1,48,20,6,8,42,
                   134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,
                   136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,1,22,16,114,
                   111,111,116,64,101,120,97,109,112,108,101,46,111,114,103,
                   49,23,48,21,6,3,85,4,3,19,14,83,69,82,86,69,82,32,82,79,
                   79,84,32,67,65,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,
                   107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,
                   15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,49,26,
                   48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
                   100,32,116,101,115,116,105,110,103,48,30,23,13,50,52,49,
                   49,48,49,49,51,48,48,48,48,90,23,13,50,54,49,49,48,49,49,
                   51,48,48,48,48,90,48,129,136,49,31,48,29,6,9,42,134,72,
                   134,247,13,1,9,1,22,16,114,111,111,116,64,101,120,97,109,
                   112,108,101,46,111,114,103,49,23,48,21,6,3,85,4,3,19,14,
                   83,69,82,86,69,82,32,82,79,79,84,32,67,65,49,18,48,16,6,
                   3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,49,11,48,
                   9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,4,10,19,6,101,
                   114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,17,97,117,
                   116,111,109,97,116,101,100,32,116,101,115,116,105,110,
                   103,48,89,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,
                   206,61,3,1,7,3,66,0,4,178,201,166,21,156,254,4,144,98,
                   151,10,175,121,79,77,213,14,73,44,178,207,92,103,54,87,
                   184,8,10,233,47,243,231,101,88,154,225,6,63,11,182,212,
                   134,120,229,112,46,69,157,8,90,124,217,248,34,72,188,88,
                   81,255,69,22,187,195,188,163,32,48,30,48,11,6,3,85,29,15,
                   4,4,3,2,1,6,48,15,6,3,85,29,19,1,1,255,4,5,48,3,1,1,255,
                   48,20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,
                   1,7,3,73,0,48,70,2,33,0,160,65,74,179,143,166,71,191,44,
                   65,106,89,117,180,68,249,190,129,119,198,169,8,115,99,
                   176,222,20,255,154,13,81,236,2,33,0,180,64,98,172,161,
                   216,243,228,83,11,87,214,1,43,235,112,182,22,44,176,173,
                   4,3,200,156,115,253,11,226,31,42,61>>,
                 <<48,130,2,67,48,130,1,223,160,3,2,1,2,2,1,2,48,20,6,8,42,
                   134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,
                   136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,1,22,16,114,
                   111,111,116,64,101,120,97,109,112,108,101,46,111,114,103,
                   49,23,48,21,6,3,85,4,3,19,14,83,69,82,86,69,82,32,82,79,
                   79,84,32,67,65,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,
                   107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,
                   15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,49,26,
                   48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
                   100,32,116,101,115,116,105,110,103,48,30,23,13,50,52,49,
                   49,49,56,49,51,48,48,48,48,90,23,13,50,52,49,49,50,54,49,
                   51,48,48,48,48,90,48,129,150,49,35,48,33,6,9,42,134,72,
                   134,247,13,1,9,1,22,20,119,101,98,97,100,109,105,110,64,
                   101,120,97,109,112,108,101,46,111,114,103,49,33,48,31,6,
                   3,85,4,3,19,24,115,101,114,118,101,114,32,73,110,116,101,
                   114,109,101,100,105,97,116,101,32,67,65,32,48,49,18,48,
                   16,6,3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,49,
                   11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,4,10,19,
                   6,101,114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,17,
                   97,117,116,111,109,97,116,101,100,32,116,101,115,116,105,
                   110,103,48,89,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,
                   72,206,61,3,1,7,3,66,0,4,226,233,64,226,236,8,203,5,233,
                   98,179,61,92,202,124,51,228,237,126,226,221,18,149,102,
                   53,255,80,108,131,200,150,103,114,140,51,74,79,45,157,
                   163,168,71,199,211,140,183,80,83,119,188,171,64,11,148,
                   40,170,230,249,165,240,129,61,43,168,163,32,48,30,48,11,
                   6,3,85,29,15,4,4,3,2,1,6,48,15,6,3,85,29,19,1,1,255,4,5,
                   48,3,1,1,255,48,20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,
                   72,206,61,3,1,7,3,72,0,48,69,2,32,49,126,232,73,78,108,
                   214,202,64,240,216,154,122,72,147,53,183,171,186,231,17,
                   235,95,65,145,54,114,148,16,200,102,198,2,33,0,249,80,
                   115,255,154,198,49,120,196,3,53,49,38,244,222,3,253,254,
                   72,55,73,13,4,81,125,101,197,157,87,87,172,16>>,
                 <<48,130,2,54,48,130,1,209,160,3,2,1,2,2,1,1,48,20,6,8,
                   42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,
                   129,136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,1,
                   22,16,114,111,111,116,64,101,120,97,109,112,108,101,
                   46,111,114,103,49,23,48,21,6,3,85,4,3,19,14,83,69,82,
                   86,69,82,32,82,79,79,84,32,67,65,49,18,48,16,6,3,85,
                   4,7,19,9,83,116,111,99,107,104,111,108,109,49,11,48,
                   9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,4,10,19,6,
                   101,114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,17,
                   97,117,116,111,109,97,116,101,100,32,116,101,115,116,
                   105,110,103,48,30,23,13,50,52,49,49,48,49,49,51,48,
                   48,48,48,90,23,13,50,54,49,49,48,49,49,51,48,48,48,
                   48,90,48,129,136,49,31,48,29,6,9,42,134,72,134,247,
                   13,1,9,1,22,16,114,111,111,116,64,101,120,97,109,112,
                   108,101,46,111,114,103,49,23,48,21,6,3,85,4,3,19,14,
                   83,69,82,86,69,82,32,82,79,79,84,32,67,65,49,18,48,
                   16,6,3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,
                   49,11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,
                   4,10,19,6,101,114,108,97,110,103,49,26,48,24,6,3,85,
                   4,11,19,17,97,117,116,111,109,97,116,101,100,32,116,
                   101,115,116,105,110,103,48,89,48,19,6,7,42,134,72,
                   206,61,2,1,6,8,42,134,72,206,61,3,1,7,3,66,0,4,178,
                   201,166,21,156,254,4,144,98,151,10,175,121,79,77,213,
                   14,73,44,178,207,92,103,54,87,184,8,10,233,47,243,
                   231,101,88,154,225,6,63,11,182,212,134,120,229,112,
                   46,69,157,8,90,124,217,248,34,72,188,88,81,255,69,22,
                   187,195,188,163,32,48,30,48,11,6,3,85,29,15,4,4,3,2,
                   1,6,48,15,6,3,85,29,19,1,1,255,4,5,48,3,1,1,255,48,
                   20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,
                   1,7,3,73,0,48,70,2,33,0,160,65,74,179,143,166,71,191,
                   44,65,106,89,117,180,68,249,190,129,119,198,169,8,
                   115,99,176,222,20,255,154,13,81,236,2,33,0,180,64,98,
                   172,161,216,243,228,83,11,87,214,1,43,235,112,182,22,
                   44,176,173,4,3,200,156,115,253,11,226,31,42,61>>]}]},
     {client,
      [{server_name_indication,disable},
       {verify,verify_peer},
       {versions,['tlsv1.3']},
       {ciphers,[#{key_exchange => any,cipher => aes_128_gcm,mac => aead,
                   prf => sha256}]},
       {cert,<<48,130,2,80,48,130,1,236,160,3,2,1,2,2,1,3,48,20,6,8,42,134,
               72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,150,49,35,
               48,33,6,9,42,134,72,134,247,13,1,9,1,22,20,119,101,98,97,
               100,109,105,110,64,101,120,97,109,112,108,101,46,111,114,
               103,49,33,48,31,6,3,85,4,3,19,24,115,101,114,118,101,114,32,
               73,110,116,101,114,109,101,100,105,97,116,101,32,67,65,32,
               48,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,107,104,111,
               108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,
               4,10,19,6,101,114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,
               17,97,117,116,111,109,97,116,101,100,32,116,101,115,116,105,
               110,103,48,30,23,13,50,52,49,49,49,56,49,51,48,48,48,48,90,
               23,13,50,52,49,49,50,54,49,51,48,48,48,48,90,48,129,139,49,
               32,48,30,6,9,42,134,72,134,247,13,1,9,1,22,17,97,100,109,
               105,110,64,101,120,97,109,112,108,101,46,111,114,103,49,25,
               48,23,6,3,85,4,3,19,16,115,101,114,118,101,114,32,80,101,
               101,114,32,99,101,114,116,49,18,48,16,6,3,85,4,7,19,9,83,
               116,111,99,107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,
               83,69,49,15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,
               49,26,48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
               100,32,116,101,115,116,105,110,103,48,89,48,19,6,7,42,134,
               72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,3,66,0,4,18,82,152,
               32,21,222,20,67,80,135,183,75,76,10,102,227,134,60,10,36,
               159,132,116,143,11,99,120,225,27,185,196,223,7,18,164,104,
               15,63,26,60,171,201,108,252,192,245,142,193,43,13,67,138,
               164,187,93,3,48,9,193,45,200,255,18,122,163,42,48,40,48,11,
               6,3,85,29,15,4,4,3,2,3,136,48,25,6,3,85,29,17,4,18,48,16,
               130,14,101,108,120,45,99,110,100,49,52,56,55,118,107,49,48,
               20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,3,
               72,0,48,69,2,33,0,249,76,34,204,122,125,172,107,125,93,26,
               195,121,140,234,117,32,209,56,202,146,137,79,235,4,133,143,
               246,144,136,143,92,2,32,109,186,153,71,133,36,244,184,228,
               71,58,47,187,103,75,77,97,16,139,24,172,5,115,4,163,184,85,
               50,174,114,196,136>>},
       {key,{'ECPrivateKey',<<48,119,2,1,1,4,32,228,91,82,33,146,248,200,
                              188,41,171,42,200,158,64,87,88,213,68,32,
                              213,131,249,207,52,168,112,192,243,129,103,
                              147,109,160,10,6,8,42,134,72,206,61,3,1,7,
                              161,68,3,66,0,4,18,82,152,32,21,222,20,67,
                              80,135,183,75,76,10,102,227,134,60,10,36,
                              159,132,116,143,11,99,120,225,27,185,196,
                              223,7,18,164,104,15,63,26,60,171,201,108,
                              252,192,245,142,193,43,13,67,138,164,187,93,
                              3,48,9,193,45,200,255,18,122>>}},
       {cacerts,[<<48,130,2,54,48,130,1,209,160,3,2,1,2,2,1,1,48,20,6,8,42,
                   134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,
                   136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,1,22,16,114,
                   111,111,116,64,101,120,97,109,112,108,101,46,111,114,103,
                   49,23,48,21,6,3,85,4,3,19,14,83,69,82,86,69,82,32,82,79,
                   79,84,32,67,65,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,
                   107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,
                   15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,49,26,
                   48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
                   100,32,116,101,115,116,105,110,103,48,30,23,13,50,52,49,
                   49,48,49,49,51,48,48,48,48,90,23,13,50,54,49,49,48,49,49,
                   51,48,48,48,48,90,48,129,136,49,31,48,29,6,9,42,134,72,
                   134,247,13,1,9,1,22,16,114,111,111,116,64,101,120,97,109,
                   112,108,101,46,111,114,103,49,23,48,21,6,3,85,4,3,19,14,
                   83,69,82,86,69,82,32,82,79,79,84,32,67,65,49,18,48,16,6,
                   3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,49,11,48,
                   9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,4,10,19,6,101,
                   114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,17,97,117,
                   116,111,109,97,116,101,100,32,116,101,115,116,105,110,
                   103,48,89,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,
                   206,61,3,1,7,3,66,0,4,178,201,166,21,156,254,4,144,98,
                   151,10,175,121,79,77,213,14,73,44,178,207,92,103,54,87,
                   184,8,10,233,47,243,231,101,88,154,225,6,63,11,182,212,
                   134,120,229,112,46,69,157,8,90,124,217,248,34,72,188,88,
                   81,255,69,22,187,195,188,163,32,48,30,48,11,6,3,85,29,15,
                   4,4,3,2,1,6,48,15,6,3,85,29,19,1,1,255,4,5,48,3,1,1,255,
                   48,20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,
                   1,7,3,73,0,48,70,2,33,0,160,65,74,179,143,166,71,191,44,
                   65,106,89,117,180,68,249,190,129,119,198,169,8,115,99,
                   176,222,20,255,154,13,81,236,2,33,0,180,64,98,172,161,
                   216,243,228,83,11,87,214,1,43,235,112,182,22,44,176,173,
                   4,3,200,156,115,253,11,226,31,42,61>>,
                 <<48,130,2,67,48,130,1,223,160,3,2,1,2,2,1,2,48,20,6,8,42,
                   134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,48,129,
                   136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,1,22,16,114,
                   111,111,116,64,101,120,97,109,112,108,101,46,111,114,103,
                   49,23,48,21,6,3,85,4,3,19,14,83,69,82,86,69,82,32,82,79,
                   79,84,32,67,65,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,
                   107,104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,
                   15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,49,26,
                   48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,116,101,
                   100,32,116,101,115,116,105,110,103,48,30,23,13,50,52,49,
                   49,49,56,49,51,48,48,48,48,90,23,13,50,52,49,49,50,54,49,
                   51,48,48,48,48,90,48,129,150,49,35,48,33,6,9,42,134,72,
                   134,247,13,1,9,1,22,20,119,101,98,97,100,109,105,110,64,
                   101,120,97,109,112,108,101,46,111,114,103,49,33,48,31,6,
                   3,85,4,3,19,24,115,101,114,118,101,114,32,73,110,116,101,
                   114,109,101,100,105,97,116,101,32,67,65,32,48,49,18,48,
                   16,6,3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,49,
                   11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,4,10,19,
                   6,101,114,108,97,110,103,49,26,48,24,6,3,85,4,11,19,17,
                   97,117,116,111,109,97,116,101,100,32,116,101,115,116,105,
                   110,103,48,89,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,
                   72,206,61,3,1,7,3,66,0,4,226,233,64,226,236,8,203,5,233,
                   98,179,61,92,202,124,51,228,237,126,226,221,18,149,102,
                   53,255,80,108,131,200,150,103,114,140,51,74,79,45,157,
                   163,168,71,199,211,140,183,80,83,119,188,171,64,11,148,
                   40,170,230,249,165,240,129,61,43,168,163,32,48,30,48,11,
                   6,3,85,29,15,4,4,3,2,1,6,48,15,6,3,85,29,19,1,1,255,4,5,
                   48,3,1,1,255,48,20,6,8,42,134,72,206,61,4,3,2,6,8,42,134,
                   72,206,61,3,1,7,3,72,0,48,69,2,32,49,126,232,73,78,108,
                   214,202,64,240,216,154,122,72,147,53,183,171,186,231,17,
                   235,95,65,145,54,114,148,16,200,102,198,2,33,0,249,80,
                   115,255,154,198,49,120,196,3,53,49,38,244,222,3,253,254,
                   72,55,73,13,4,81,125,101,197,157,87,87,172,16>>,
                 <<48,130,2,54,48,130,1,209,160,3,2,1,2,2,1,1,48,20,6,
                   8,42,134,72,206,61,4,3,2,6,8,42,134,72,206,61,3,1,7,
                   48,129,136,49,31,48,29,6,9,42,134,72,134,247,13,1,9,
                   1,22,16,114,111,111,116,64,101,120,97,109,112,108,
                   101,46,111,114,103,49,23,48,21,6,3,85,4,3,19,14,83,
                   69,82,86,69,82,32,82,79,79,84,32,67,65,49,18,48,16,
                   6,3,85,4,7,19,9,83,116,111,99,107,104,111,108,109,
                   49,11,48,9,6,3,85,4,6,19,2,83,69,49,15,48,13,6,3,85,
                   4,10,19,6,101,114,108,97,110,103,49,26,48,24,6,3,85,
                   4,11,19,17,97,117,116,111,109,97,116,101,100,32,116,
                   101,115,116,105,110,103,48,30,23,13,50,52,49,49,48,
                   49,49,51,48,48,48,48,90,23,13,50,54,49,49,48,49,49,
                   51,48,48,48,48,90,48,129,136,49,31,48,29,6,9,42,134,
                   72,134,247,13,1,9,1,22,16,114,111,111,116,64,101,
                   120,97,109,112,108,101,46,111,114,103,49,23,48,21,6,
                   3,85,4,3,19,14,83,69,82,86,69,82,32,82,79,79,84,32,
                   67,65,49,18,48,16,6,3,85,4,7,19,9,83,116,111,99,107,
                   104,111,108,109,49,11,48,9,6,3,85,4,6,19,2,83,69,49,
                   15,48,13,6,3,85,4,10,19,6,101,114,108,97,110,103,49,
                   26,48,24,6,3,85,4,11,19,17,97,117,116,111,109,97,
                   116,101,100,32,116,101,115,116,105,110,103,48,89,48,
                   19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,
                   1,7,3,66,0,4,178,201,166,21,156,254,4,144,98,151,10,
                   175,121,79,77,213,14,73,44,178,207,92,103,54,87,184,
                   8,10,233,47,243,231,101,88,154,225,6,63,11,182,212,
                   134,120,229,112,46,69,157,8,90,124,217,248,34,72,
                   188,88,81,255,69,22,187,195,188,163,32,48,30,48,11,
                   6,3,85,29,15,4,4,3,2,1,6,48,15,6,3,85,29,19,1,1,255,
                   4,5,48,3,1,1,255,48,20,6,8,42,134,72,206,61,4,3,2,6,
                   8,42,134,72,206,61,3,1,7,3,73,0,48,70,2,33,0,160,65,
                   74,179,143,166,71,191,44,65,106,89,117,180,68,249,
                   190,129,119,198,169,8,115,99,176,222,20,255,154,13,
                   81,236,2,33,0,180,64,98,172,161,216,243,228,83,11,
                   87,214,1,43,235,112,182,22,44,176,173,4,3,200,156,
                   115,253,11,226,31,42,61>>]}]}].
